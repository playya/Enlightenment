CREATE TABLE theme_theme_group (id INT AUTO_INCREMENT, name VARCHAR(255), theme_id INT, theme_group_id INT, created_at DATETIME, updated_at DATETIME, INDEX theme_id_idx (theme_id), INDEX theme_group_id_idx (theme_group_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE application (id INT AUTO_INCREMENT, name VARCHAR(255), description TEXT, source_url TEXT, downloads INT, rating DOUBLE, showcase TINYINT(1), approved TINYINT(1), user_id INT, created_at DATETIME, updated_at DATETIME, INDEX user_id_idx (user_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE madule (id INT AUTO_INCREMENT, name VARCHAR(255), description TEXT, source_url TEXT, downloads INT, rating DOUBLE, showcase TINYINT(1), approved TINYINT(1), application_id INT, user_id INT, created_at DATETIME, updated_at DATETIME, INDEX user_id_idx (user_id), INDEX application_id_idx (application_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE comment (id INT AUTO_INCREMENT, comment TEXT, application_id INT, madule_id INT, theme_id INT, user_id INT, created_at DATETIME, updated_at DATETIME, INDEX application_id_idx (application_id), INDEX madule_id_idx (madule_id), INDEX theme_id_idx (theme_id), INDEX user_id_idx (user_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE rating (id INT AUTO_INCREMENT, value INT, application_id INT, madule_id INT, theme_id INT, user_id INT, INDEX application_id_idx (application_id), INDEX madule_id_idx (madule_id), INDEX theme_id_idx (theme_id), INDEX user_id_idx (user_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE application_theme_group (id INT AUTO_INCREMENT, name VARCHAR(255), application_id INT, theme_group_id INT, created_at DATETIME, updated_at DATETIME, INDEX application_id_idx (application_id), INDEX theme_group_id_idx (theme_group_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE theme_group (id INT AUTO_INCREMENT, name VARCHAR(255), title VARCHAR(255), known TINYINT(1), created_at DATETIME, updated_at DATETIME, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE theme (id INT AUTO_INCREMENT, name VARCHAR(255), author VARCHAR(255), license VARCHAR(255), version VARCHAR(255), description TEXT, file_name VARCHAR(255), downloads INT, rating DOUBLE, showcase TINYINT(1), approved TINYINT(1), user_id INT, created_at DATETIME, updated_at DATETIME, INDEX user_id_idx (user_id), PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE user (id INT AUTO_INCREMENT, name VARCHAR(255), email VARCHAR(255), password VARCHAR(255), role INT, hash VARCHAR(50), api_key VARCHAR(50), active TINYINT(1), created_at DATETIME, updated_at DATETIME, PRIMARY KEY(id)) ENGINE = INNODB;
CREATE TABLE madule_theme_group (id INT AUTO_INCREMENT, name VARCHAR(255), madule_id INT, theme_group_id INT, created_at DATETIME, updated_at DATETIME, INDEX madule_id_idx (madule_id), INDEX theme_group_id_idx (theme_group_id), PRIMARY KEY(id)) ENGINE = INNODB;
ALTER TABLE theme_theme_group ADD FOREIGN KEY (theme_id) REFERENCES theme(id);
ALTER TABLE theme_theme_group ADD FOREIGN KEY (theme_group_id) REFERENCES theme_group(id);
ALTER TABLE application ADD FOREIGN KEY (user_id) REFERENCES user(id);
ALTER TABLE madule ADD FOREIGN KEY (user_id) REFERENCES user(id);
ALTER TABLE madule ADD FOREIGN KEY (application_id) REFERENCES application(id);
ALTER TABLE comment ADD FOREIGN KEY (user_id) REFERENCES user(id);
ALTER TABLE comment ADD FOREIGN KEY (theme_id) REFERENCES theme(id);
ALTER TABLE comment ADD FOREIGN KEY (madule_id) REFERENCES madule(id);
ALTER TABLE comment ADD FOREIGN KEY (application_id) REFERENCES application(id);
ALTER TABLE rating ADD FOREIGN KEY (user_id) REFERENCES user(id);
ALTER TABLE rating ADD FOREIGN KEY (theme_id) REFERENCES theme(id);
ALTER TABLE rating ADD FOREIGN KEY (madule_id) REFERENCES madule(id);
ALTER TABLE rating ADD FOREIGN KEY (application_id) REFERENCES application(id);
ALTER TABLE application_theme_group ADD FOREIGN KEY (theme_group_id) REFERENCES theme_group(id);
ALTER TABLE application_theme_group ADD FOREIGN KEY (application_id) REFERENCES application(id);
ALTER TABLE theme ADD FOREIGN KEY (user_id) REFERENCES user(id);
ALTER TABLE madule_theme_group ADD FOREIGN KEY (theme_group_id) REFERENCES theme_group(id);
ALTER TABLE madule_theme_group ADD FOREIGN KEY (madule_id) REFERENCES madule(id);
