How E's Web Works
-----------------

This website uses an old scheme that we continue to use.
The web/e directory serves as the web root for enlightenment.org.
In this directory is found the following:

index.php	A redirect PHP script to pages/news.html
s/		A script directory for building the site
config/		A directory containing various web elements
		including page headers, footers and nav bars
data/		A directory containing the unparsed HTML pages.
		These are the files you want to edit!
pages/		A directory containing the parsed and output	
		HTML that will be seen by the world.
pages/img/	A directory containing images to be used by the HTML.


To update, for instance, the news, edit data/news.html.  Follow the
current format used and save that file. Then, in this directory (web/e)
run the build script "s/make", this will rebuild all the pages from
the data/ HTML directory.  This actually done by the parse program included
in the s/ direcotry, but shadowed from the user via the make script.

Always udpate cvs BEFORE you cvs commit, otherwise a commit will end up recommiting
every page, instead of just the ones you edited.  If you do things
properly, you should always be commiting at least 2 HTML files.



How to actually update the site
-------------------------------

To actually put the pages on the web, you need to log into the SF shell server.
Once your there, you can change directory to the htdocs base dir and just do
a simple "cvs update" from there, if you add new files, make sure to use 
"cvs update -d".  Do NOT just simply wipe the directory and do a clean checkout!
I actually alias the htdocs base dir so that I don't have to type it out.  Here's
how it works:

[benr@nexus benr]$ ssh -l technikolor shell.sourceforge.net
technikolor@shell.sourceforge.net's password: 
 (blah blah)
technikolor@sc8-pr-shell1:~$ alias
alias htdocs='cd /home/groups/e/en/enlightenment/htdocs'	<-- thats the directory
technikolor@sc8-pr-shell1:~$ htdocs
technikolor@sc8-pr-shell1:/home/groups/e/en/enlightenment/htdocs$ ls
config  CVS  data  doxy  index.crap  index.php  Makefile  pages  README  s  temp
technikolor@sc8-pr-shell1:/home/groups/e/en/enlightenment/htdocs$ cvs update
? doxy
? index.crap
 (blah blah)
technikolor@sc8-pr-shell1:/home/groups/e/en/enlightenment/htdocs$ exit

NOTE: Leave that "doxy" directory alone! (See below)


How the E docs are autogenerated nightly
----------------------------------------

This is something that currently my user account (technikolor) is responsable for.
I hacked up a shell script that pulls CVS each night freshly and runs a gendoc for each
applicable codbase and then moves the docs to the appropriate place.  This is the ONLY
thing that makes me (benr aka technikolor) "special", otherwise everyone can do the same stuff
I can assuming you have E SF dev access.

The script is below.  I run this from cron:
technikolor@sc8-pr-shell1:~$ crontab -l
# DO NOT EDIT THIS FILE - edit the master and reinstall.
# (/tmp/crontab.9901 installed on Mon Mar  8 01:03:02 2004)
# (Cron version -- $Id$)
0 0 * * * /home/users/t/te/technikolor/gen_site_docs.sh >&/dev/null


The script:
==========================================================================[Script Begin]
#!/bin/bash

export CVSROOT=":pserver:anonymous@cvs1:/cvsroot/enlightenment"


## First Check Out CVS

cd
#cvs co e17/libs

## Now run around creating docs.

# EVAS
echo "Generating EVAS\n"
rm -rf /home/groups/e/en/enlightenment/htdocs/doxy/evas/*
cd
cvs co e17/libs/evas
cd e17/libs/evas
./gendoc
cd doc/html
cp -a . /home/groups/e/en/enlightenment/htdocs/doxy/evas/
cd ../latex && make pdf && mv refman.pdf /home/groups/e/en/enlightenment/htdocs/doxy/evas/evas-reference.pdf

# EET
echo "Generating EET\n"
rm -rf /home/groups/e/en/enlightenment/htdocs/doxy/eet/*
cd
cvs co e17/libs/eet
cd e17/libs/eet
./gendoc
cd doc/html
cp -a . /home/groups/e/en/enlightenment/htdocs/doxy/eet/
cd ../latex && make pdf && mv refman.pdf /home/groups/e/en/enlightenment/htdocs/doxy/eet/eet-reference.pdf

# Ecore
echo "Generating Ecore\n"
rm -rf /home/groups/e/en/enlightenment/htdocs/doxy/ecore/*
cd
cvs co e17/libs/ecore
cd e17/libs/ecore
./gendoc
cd doc/html
cp -a . /home/groups/e/en/enlightenment/htdocs/doxy/ecore/
cd ../latex && make pdf && mv refman.pdf /home/groups/e/en/enlightenment/htdocs/doxy/ecore/ecore-reference.pdf

# Ecore
echo "Generating Edje\n"
rm -rf /home/groups/e/en/enlightenment/htdocs/doxy/edje/*
cd
cvs co e17/libs/edje
cd e17/libs/edje
./gendoc
cd doc/html
cp -a . /home/groups/e/en/enlightenment/htdocs/doxy/edje/
cd ../latex && make pdf && mv refman.pdf /home/groups/e/en/enlightenment/htdocs/doxy/edje/edje-reference.pdf

# Epeg
echo "Generating Epeg\n"
rm -rf /home/groups/e/en/enlightenment/htdocs/doxy/epeg/*
cd
cvs co e17/libs/epeg
cd e17/libs/epeg
./gendoc
cd doc/html
cp -a . /home/groups/e/en/enlightenment/htdocs/doxy/epeg/
cd ../latex && make pdf && mv refman.pdf /home/groups/e/en/enlightenment/htdocs/doxy/epeg/epeg-reference.pdf


# Ewl
echo "Generating Ewl\n"
rm -rf /home/groups/e/en/enlightenment/htdocs/doxy/ewl/*
cd
cvs co e17/libs/ewl
cd e17/libs/ewl
doxygen
cd doc/html
cp -a . /home/groups/e/en/enlightenment/htdocs/doxy/ewl/
cd ../latex && make pdf && mv refman.pdf /home/groups/e/en/enlightenment/htdocs/doxy/ewl/ewl-reference.pdf


########

cd
rm -rf e17/

echo "\nDone!\n" 
==========================================================================[Script End]


Last Updated: 6/28/04 by benr (aka: technikolor)
		
