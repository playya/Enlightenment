@top@
@start@
<h2>Eprog</h2>
<div style="text-align:left">
<h3>What is it?</h3>
<p>Eprog is a convenience library for evas2, a canvas library written by <a href="http://www.rasterman.com">Raster</a>. It handles the creation of XFree86 toplevel windows that contain an evas, and takes care of feeding X events to the evas. Basically, it makes using Evas with XFree86 a whole lot easier.</p>
<p>In the words of raster, "eprog is a 'I just want to quickly write a custom canvas app and don't want to mess with setting up all the damn callbacks for everyting myself' lib."</p>

<h3>How do I use it?</h3>
<p>A quick example bit of code, with some comments.</p>
<pre>
#include &lt;Eprog.h&gt;

void
main()
{
  /* we need an E_Prog pointer */
  E_Prog *epg;
	
  /* initialize the subsystem */
  eprog_init();
	
  /* create an E_Prog */
  epg = eprog_new();
	
  /* give it a default size */
  eprog_resize(epg, 100, 100);

  /* show the thing */
  eprog_show(epg);

  /* start processing events */
  eprog_event_loop();
}
</pre>
<p>Ok, so now we have a basic little app. If you compile this using:</p>
<p><code>gcc `eprog-config --libs --cflags` -o test test.c</code></p>
<p>As you can see if you run the program, a window is shown. Inside the window is an evas, however, since nothing is on the evas, it shows only gibberish. From here you can start drawing on the evas (before starting the event loop).
</p>
<p>Let's start out by adding the image:</p>
<pre>
#include &lt;Eprog.h&gt;

void
main()
{
  E_Prog *epg;
  Evas_Object *obj; /* we need an Evas_Object pointer */

  eprog_init();

  epg = eprog_new();
  eprog_resize(epg, 100, 100);
  eprog_show(epg);

  /* create the image object */
  obj = evas_object_image_add(epg-&gt;evas);
  
  /* set the file to load */
  evas_object_image_file_set(obj, "/path/to/image.png", NULL);

  /* move, resize, set the image fill, and show the image */
  evas_object_move(obj, 0, 0);
  evas_object_resize(obj, epg-&gt;size.w, epg-&gt;size.h);
  evas_object_image_fill_set(obj, 0, 0, epg-&gt;size.w, epg-&gt;size.h);
  evas_object_show(obj);
	
  eprog_event_loop();
}
</pre>
<p>Recompile, and you've got a window showing your image. However, if we resize the window, gibberish from the evas shows in the new areas. This is because, once again, the evas has no contents there. Say we want to keep the image the full size of the evas. We can do that by setting the resize handler. The resize handler is a function that gets called whenever the window is resized. This function must be declared as follows:</p>
<p><code>function_name(void *data, E_Prog *epg);</code></p>
<p>Now lets see an example of a resize handler that keeps our image at the full evas size:</p>
<pre>
void
resize_handler(void *data, E_Prog *epg)
{
  Evas_Object *obj = data;

  evas_object_resize(obj, epg-&gt;size.w, epg-&gt;size.h);
  evas_object_image_fill_set(obj, 0, 0, epg-&gt;size.w, epg-&gt;size.h);
}
</pre>
<p>Of course we also need to set the resize handler, and tell it to pass in the evas object. To do this add the following line after obj has been created:</p>
<p><code>eprog_resize_handler_set(epg, resize_handler, obj);</code></p>

<p>Now, if the image has any parts that are transparent, you'll still have gibberish showing through underneath. This can be fixed by adding a rectangle to the evas and setting the image at a higher layer than the rectangle.	Another possible course of action is to shape the window to the contents of the evas. This allows the contents of the background to show through the transparant areas. This can be done by simpling calling:</p>
<p><code>eprog_shaped_set(epg, 1);</code></p>
<p>If we're going to shape our window, we may also want to remove its border:</p>
<p><code>eprog_borderless_set(epg, 1);</code></p>

<p>Now for the <a href="code/eprog_example.c">final code</a></p>
<pre>
#include &lt;Eprog.h&gt;

void resize_handler(void *data, E_Prog *epg);

void
main()
{
  E_Prog *epg;
  Evas_Object  *obj;

  eprog_init();

  epg = eprog_new();

  eprog_resize(epg, 341, 50);
  eprog_shaped_set(epg, 1);
  eprog_borderless_set(epg, 1);

  eprog_show(epg);

  obj = evas_object_image_add(epg-&gt;evas);
  evas_object_image_file_set(obj, "rephorm.png", NULL);
  evas_object_move(obj, 0, 0);
  evas_object_resize(obj, epg-&gt;size.w, epg-&gt;size.h);
  evas_object_image_fill_set(obj, 0, 0, epg-&gt;size.w, epg-&gt;size.h);
  evas_object_show(obj);


  eprog_resize_handler_set(epg, resize_handler, obj);

  eprog_event_loop();
}

void
resize_handler(void *data, E_Prog *epg)
{
  Evas_Object *obj = data;

  evas_object_resize(obj, epg-&gt;size.w, epg-&gt;size.h);
  evas_object_image_fill_set(obj, 0, 0, epg-&gt;size.w, epg-&gt;size.h);
}
</pre>
<p>For a good image to use (save it as rephorm.png in the same dir as the source):</p>
<p><img src="img/rephorm2.png" alt="rephorm" /></p>
</div>

@end@
@bottom@
