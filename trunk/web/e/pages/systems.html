<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <meta name="keywords" content="Enlightenment, Window, Manager, X Windows,
	 	                 X11, Themes, Efsd, Evas, Imlib">
  <title>W W W . E N L I G H T E N M E N T . O R G</title>
  <link rel="stylesheet" type="text/css" href="stylesheet.css">
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
  <link rel="icon" href="favicon.ico" type="image/ico">
  <link rel="shortcut icon" href="favicon.ico" type="image/ico">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
  <style type="text/css">img {behavior: url("png.htc");} </style>
  <script language="JavaScript" type="text/javascript">
  <!--
    var supported = /MSIE (5\.5)|[6789]/.test(navigator.userAgent) && navigator.platform == "Win32";

    function adjust()
    {
      var object;
      
      if (!supported) return;
      object = document.getElementById("bottom");
      adjust_obj(object, "i/bottom.png");
    }
    function adjust_obj(object, img)
    {
      object.style.background = "url(img/blank.gif)";
      object.runtimeStyle.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader(src='" + img + "', sizingMethod='crop');";
    }
  -->
  </script>  
</head>

<body
onLoad="adjust();"
>

<img src="img/banner-top.png" width=700 height=149 alt="Enlightenment.org">

<table border="0" width="100%" cellspacing="0" align="center">
<tr>
<td valign="top">
	<div class="navbar">

<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
  <td valign="top" align="center" width="100%">

<ul class="navsection"><p class="navtitle">Project</p>
<li><a class="navelement" href="main.html">Overview</a>
<li><a class="navelement" href="news.html"><font color=#A36209>News</font></a>
<li><a class="navelement" href="faq.html">FAQ</a>
<li><a class="navelement" href="docs.html">Documentation</a>
<li><a class="navelement" href="http://sourceforge.net/project/showfiles.php?group_id=2">Releases</a>
<li><a class="navelement" href="source.html">Source</a>
<li><a class="navelement" href="support.html">Community</a>
<li><a class="navelement" href="join.html">Join Us!</a>
</ul>

<ul class="navsection"><p class="navtitle">DR16</p>
<li><a class="navelement" href="dr16.html">Enlightenment</a>
<li><a class="navelement" href="imlib.html">Imlib</a>
<li><a class="navelement" href="shots.html">Screenshots</a>
<li><a class="navelement" href="download.html">Get DR16</a>
<li><a class="navelement" href="http://themes.freshmeat.net/browse/60/?topic_id=60">Themes [fm]</a>
</ul>

<ul class="navsection"><p class="navtitle">EFL</p>
<li><a class="navelement" href="efl.html">Overview</a>
<li><a class="navelement" href="imlib2.html">Imlib2</a>
<li><a class="navelement" href="edb.html">Edb</a>
<li><a class="navelement" href="eet.html">EET</a>
<li><a class="navelement" href="evas.html">Evas</a>
<li><a class="navelement" href="ecore.html">Ecore</a>
<!--
<li><a class="navelement" href="epeg.html">EPEG</a>
<li><a class="navelement" href="epsilon.html">Epsilon</a>
<li><a class="navelement" href="embryo.html">Embryo</a>
-->
<!-- Depreciated!
<li><a class="navelement" href="ewd.html">EWD</a>
<li><a class="navelement" href="estyle.html">Estyle</a>
-->
<li><a class="navelement" href="etox.html">Etox</a>
<li><a class="navelement" href="edje.html">Edje</a>
<li><a class="navelement" href="ewl.html">EWL</a>
<!-- 
<li><a class="navelement" href="efsd.html">Efsd</a>
-->
</ul>

<ul class="navsection"><p class="navtitle">DR17</p>
<li><a class="navelement" href="enlightenment.html">Enlightenment</a>
<li><a class="navelement" href="elicit.html">Elicit</a>
<li><a class="navelement" href="http://atmos.org/docs/entice/index.html">Entice</a>
<li><a class="navelement" href="http://evidence.sourceforge.net/">Evidence</a>
<li><a class="navelement" href="http://xcomputerman.com/pages/entrance.html">Entrance</a>
<!-- 
<li><a class="navelement" href="http://www.cuddletech.com/">Euphoria</a>
-->
<li><a class="navelement" href="erss.html">eRSS</a>
<li><a class="navelement" href="systems.html">Systems</a>
</ul>

<ul class="navsection"><p class="navtitle">Development</p>
<li><a class="navelement" href="team.html">The Team</a>
<li><a class="navelement" href="http://cia.navi.cx/stats/project/e/.rss">CVS RSS</a>
<li><a class="navelement" href="http://cia.navi.cx/stats/project/e">CIA</a>
<li><a class="navelement" href="http://xcomputerman.com/bugs/login_page.php">BugTrack</a>
<li><a class="navelement" href="logos.html">Logos</a>
<li><a class="navelement" href="links.html">Links</a>
</ul>

<a href="http://sourceforge.net/projects/enlightenment/"><img src="http://sourceforge.net/sflogo.php?group_id=2&amp;type=1" width="88" height="31" border="0" alt="SourceForge Logo"></a>

</td>
</tr>
</table>
</div>

</td>
<td valign="top" width="100%">

<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
  <td valign="top" width="100%">

<div class="content">

<p class="contenttitle">Enlightenment's Core Systems</p>
<br>

<p>
Enlightenment has grown to be much more than a window manager. It has many
systems that have grown on their own to support development of the next
version (0.17) and all the effort is going into solidifying these systems to
be more than solid to build on. This has lead to a lot of code being produced
that is useful far and beyond a window manager. The idea is to share as much
code as possible with other programs, and so a small army of shared libraries
has evolved for Enlightenment. This page attempts to cover some of these
(especially the more interesting ones) to give a good insight into why they
exist, what they do, how to use them, and where they are going.
</p><p>
We refer to these systems as the <a href=efl.html>EFL or Enlightenment
Foundation Libraries</a>, as they are the foundation of the project and the
currently contain all the hard work. The intent is to have libraries that are
extremely easy to use and learn, that optimize automatically for the programmer
where possible and save the programmer time and effort in the long run. We
believe we have achieved many of these goals and have some very unique
aspects that may be of great interest to developers outside of the project to
create some interesting or even amazing tools.
</p><p>
<img src=img/sys_evas.png width=318 height=100>
</p>
<img src=img/sys_evas_shot1.png width=240 height=320 class=sshot align=right alt="Evas performance test program" hspace=16 vspace=16>
<p>
Evas is a display canvas. This is different to the usual "immediate mode"
display system that most programmers are used to and exists at the Xlib, GDI
and even OpenGL levels when doing graphics programming. The difference is
that the programmer has to call routines to DRAW the screen or updated
display by drawing one operation at a time, such as draw line, paste image,
draw box, paste text. When the screen needs an update these operations are
done again by the code, normally from the bottom-most element in the draw to
the top (painters algorithm). This is "immediate mode" drawing. Evas is
different. It is structural by nature, so instead of drawing, you describe
the canvas contents (or scene) in terms of primitives (images, lines, boxes,
polygons, text strings etc.) and properties (color, stacking, size, etc.).
The drawing itself is handled by the canvas, which acts as a state machine,
not actually doing any "hard work" until the canvas's render call is
executed, at which time it evaluates the previous and the current state and
appropriately updates the screen without the programmer having to know how
this is done.
</p>
<img src=img/sys_evas_shot2.png width=240 height=320 class=sshot align=left alt="Ecore Evas test program" hspace=16 vspace=16>
<p>
Evas is a very core part of the <a href=efl.html>EFL</a>. It is the rendering
and display management engine that sits under anything you see on a screen.
It does all the work of managing display objects, their state, state changes,
layering, rendering and scaling, image loading, text rendering, update
handling, optimizing the display pipeline to avoid work and more. It does a
lot of the grunt work of display, and is portable beyond
<a href=http://www.x.org>X</a>. It even runs in the framebuffer directly
without needing <a href=http://www.x.org>X</a>, under
<a href=http://www.trolltech.com/products/qtopia/index.html>Trolltech's
Qtopia</a>, on <a href=http://www.directfb.org>DirectFB</a>, can
render into a memory buffer, and use <a href=http://www.opengl.org/>OpenGL</a>
to accelerate rendering. It is extremely flexible and very powerful, saving a
lot of time writing repetitive drawing routines that often end up not
performing optimally as to do so takes a lot of time, care and effort that
most programmers would not want to spend, because it distracts from the
important work of making their application.
</p><p>
<img src=img/sys_evas_keitai.png width=225 height=246 align=right alt="Evas on embedded" hspace=16 vspace=16>
</p><p>
But despite all of the things that Evas can do, it is not very large. It has
been kept small and lean to make it viable for use on NOT just heavy-weight
desktops, but also on limited resource devices such as PDA's, mobile phones
and Smart phones, Stereo systems, DVD Players, PVR/DVR Systems and more. It
has already been ported to Mobile phones and PDA's, PVR/DVR systems and has
proved itself capable of driving these displays very nicely with beautiful
effects. The developer does not have to change how they code for a device or
their desktop as the API and rendering are the same, so no special
development environments or emulators are needed. This saves time and effort,
allowing desktop and device code to be shared and maintained easily. Also
since Evas hides the details of the devices display format, and virtualizes
the display at an object level, the programmer doesn't need to care how to
render things. They can use a standard system that is universal across all
instances of Evas.
</p><p>
Evas provides alpha blending, high quality scaling of images, anti-aliased
truetype text, gradients, lines, polygons and more. The list of supported
objects is growing, and can be extended via smart objects. It has an interface
mechanism to allow for video data to be efficiently handled (which is what
Emotion exploits) and more.
</p><p>
<img src=img/sys_ecore.png width=318 height=100>
</p><p>
Ecore is a modular group of very closely linked libraries that provide core
event loop functionality and related tasks. As the core event loop it
provides conversion of system signals into events, to avoid having to have
re-entrant code, handle basic file descriptor watching and passing off
control to appropriate callback routines where needed, handling timers, idle
calls, and other general program infrastructure and loop code.
</p><p>
It also provides easy to use wrappers around common systems such as X, Evas
(for setup and combining with X), the frame-buffer, configuration management,
inter process communication, socket handling, client/server programming, text
encoding conversions (e.g. EUCJP to UTF8), deferred job handling and more. This
library is a big time saver and core infrastructure library that can be used
to do all the basic things applications need to do, with minimal code and
effort.
</p><p>
The best way to describe Ecore is as the cement between the bricks. It holds
things together very nicely. In the later examples a lot of the setup and
infrastructure are thanks to Ecore.
</p><p>
<img src=img/sys_edje.png width=318 height=100>
</p><p>
<a href=img/sys_edje_shot1.png><img src=img/sys_edje_shot1_thm.png width=256 height=192 class=sshot align=right alt="Edje Test program" hspace=16 vspace=16 border=0></a>
</p><p>
Edje is one of the more unique parts of EFL, combining many things that
<a href=http://www.macromedia.com>Shockwave / FLASH</a> can do with some things
it can't, but instead of being designed as a player, it is designed as a
slave library to be used by an application to enhance the applications
content and display via external compressed data files. It is being expanded
continuously, and thanks to its simple design is easy to improve. This is the
theme engine behind Enlightenment 0.17 and beyond and at last formalizes
Enlightenment themes in a simple and consistent manner.
</p><p>
A Quick list of its features:
<ul>
<li>Scalable bitmap images</li>
<li>Highly compressed in-lined images</li>
<li>Lossless and lossy compression with or without alpha channel</li>
<li>In-lined compressed truetype fonts</li>
<li>Multiple inbuilt font effects</li>
<li>Automatic font sizing based on size or area</li>
<li>Text compression and ellipsis based cutting</li>
<li>Rectangle objects</li>
<li>Configurable color scheme system</li>
<li>Ability to embed Edje objects within Edje objects</li>
<li>Embryo scripting language for complex interactions</li>
<li>Sand-boxed scripts so they cannot do much damage</li>
<li>Alpha blending</li>
<li>Completely scalable and re-sizable layout and interface metrics</li>
<li>Completely calculated tweened animation for ultra-smooth display</li>
</ul>
</p><p>
Currently Edje includes a C-like source file format (using braces and nesting
similar to C syntax with XML-like nesting) known as "EDC" files that are
compiled into binary archive "EET" files that are then used by the Edje
library for display - just like a PNG or JPEG are not "source" themselves -
they are a compressed, machine-friendly representation of an image. The same
goes for EET files.
</p><p>
The plan in the long term is to provide a new version of the old Etcher tool
that was produced for a predecessor prototype for Edje (called Ebits) which
gave a user a powerful GUI tool to create such files and edit them. Since
Edje is so much more powerful and complex than Ebits ever was, this work has
not yet been done, but is on the drawing-board.
</p><p>
<img src=img/sys_embryo.png width=318 height=100>
</p><p>
Embryo is a virtual machine and compiler based on the
<a href=http://www.compuphase.com/small.htm>Small</a> programming language.
It has had many bugs fixed and a lot of portability work done to the engine
and the compiler. It has been made smaller and simpler making it ideal for
inclusion into any program wanting to use small pieces of "script logic"
within a more complex system, but don't want to bring in the massive
resources required by other languages such as Perl, Python, Java, Ruby, etc.
</p><p>
The Embryo engine is tiny. The core engine is less than 1700 lines of clean C
code, with the entire virtual machine including basic string manipulation and
math routines, headers and utility code being only 3000 lines of code. The
memory requirements for a script are about 8-16Kb of RAM, and they execute
very quickly as they are already compiled into bytecode.
</p><p>
Embryo scripts are completely sand-boxed, so they cannot access files,
allocate memory, access the network, control processes or do anything that
hasn't been explicitly granted to them as a natively exported function call.
Therefore an Embryo script by nature is very safe in addition to being small
and very fast. The only damage it can do is via any function calls a program
may provide to let the script interface with the system, and this is the same
danger inherent in ALL systems. The advantage is that the programmer doesn't
need to worry about problems outside of this.
</p><p>
As an example of what an embryo script would look like, here is a simple
recursive program with some basic programming constructs and operations:
</p><p>
<div class=fragment>
<pre>
/* this is exported by the embryo test program so you can output results */
native printf(format[], ...);

/* in a stand-alone embryo script this is the function that is always called */
/* first, otherwise it may work like a library where a caller program may */
/* call specific functions */
main()
{
  new Float:value = randf();
  
  if (value > 0.5)
    {
       new i;
       
       for (i = 0; i < 20; i++)
         {
	    printf("value = %f, i = %i\n", value, i);
	 }
    }
  else
    {
       new val;
       
       val = recurse(3);
       printf("val = %i\n", val);
    }
}

recurse(val)
{
   printf("recurse... val = %i\n", val);
   if (val >= 10) return val;
   return recurse(val + 1);
}
</pre>
</div>
</p><p>
Embryo provides a full Turing-complete and minimal implementation of the
Small programming language (compiler and virtual machine). It is not intended
to be a new programing language to write applications in (like Java, .NET/C#,
Perl, Python etc.), but to be able to augment the core logic of an existing
application with scripted code fragments to tie logic together in a
customisable way.
</p><p>
<img src=img/sys_eet.png width=318 height=100>
</p><p>
Eet is a small and very useful library that does 2 things. It acts as a
miniature "ZIP FILE" library. It doesn't handle ZIP format files as the ZIP
format is more complex than is needed, but it does a similar thing where it
can store multiple "files" within 1 compressed archive file AND randomly
access every "file" within the archive very quickly, and decompress for you.
This library can create such files and access them very efficiently. It can
ALSO encode data within such files. It can save image pixel data in various
formats as well as encode and decode C structs in memory so it is easy to
store data and retrieve it as all that is needed is to feed in the pointer to
a C struct in memory to save, and the reverse to load. It makes storage and
retrieval of data structures in memory becomes an easy process. It can also
simply serialize this data for transmission across a network too. Eet is a
big time-saver and is the workhorse underneath Edje for doing the data
storage it needs.
</p><p>
<img src=img/sys_emotion.png width=318 height=100>
</p><p>
<a href=img/sys_emotion_shot1.png><img src=img/sys_emotion_shot1_thm.png width=256 height=205 class=sshot align=left alt="Emotion Test program" hspace=16 vspace=16 border=0></a>
</p><p>
Emotion is the one of the newest libraries, but it shows the strength of what
it is built on by its rapid development. Emotion is a video & media object
library designed to interface with Evas and Ecore to provide autonomous
"video" and "audio" objects that can be moved, resized and positioned like any
normal object, but instead they can play video and audio and can be
controlled from a high-level control API allowing the programmer to quickly
piece together a multi-media system with minimal work. Emotion provides a
modular decoder layer system where a decoder module can be plugged in
separately to provide decoding resources for Emotion. Emotion currently has 1
decoder module that uses <a href=http://www.xinehq.de>XINE</a> as the
decoder, allowing it to play DVD's, MPEG's, AVI's, MOV's, WMV's and much
more. Its test program is already a useful DVD player (without a lot of the
fancy control interface) and can play multiple video streams with
semi-translucency and more.
</p><p>
To show how easy Emotion makes it to put a video file, DVD, VCD or other
media content within a canvas take a look at the following program. It is a
complete DVD player (very simple with limited mouse controls over the DVD
menus, no handling of aspect ratio change etc, but it works). This is all of
56 lines of C code.
</p><p>
<div class=fragment>
<pre>
#include <Evas.h>
#include <Ecore.h>
#include <Ecore_Evas.h>
#include <Emotion.h>

Evas_Object *video;

/* if the window manager requests a delete - quit cleanly */
static void
canvas_delete_request(Ecore_Evas *ee)
{
   ecore_main_loop_quit();
}

/* if the canvas is resized - resize the video too */
static void
canvas_resize(Ecore_Evas *ee)
{
   Evas_Coord w, h;
   
   evas_output_viewport_get(ecore_evas_get(ee), NULL, NULL, &w, &h);
   evas_object_move(video, 0, 0);
   evas_object_resize(video, w, h);
}

/* the main function of the program */
int main(int argc, char **argv)
{
   Ecore_Evas *ee;

   /* create a canvas, display it, set a title, callbacks to call on resize */
   /* or if the window manager asks it to be deleted */
   ecore_evas_init();
   ee = ecore_evas_software_x11_new(NULL, 0, 0, 0, 800, 600);
   ecore_evas_callback_delete_request_set(ee, canvas_delete_request);
   ecore_evas_callback_resize_set(ee, canvas_resize);   
   ecore_evas_title_set(ee, "My DVD Player");
   ecore_evas_name_class_set(ee, "my_dvd_player", "My_DVD_Player");
   ecore_evas_show(ee);

   /* create a video object */
   video = emotion_object_add(ecore_evas_get(ee));
   emotion_object_file_set(video, "dvd:/");
   emotion_object_play_set(video, 1);
   evas_object_show(video);

   /* force an initial resize */
   canvas_resize(ee);
   
   /* run the main loop of the program - playing, drawing, handling events */
   ecore_main_loop_begin();
   
   /* if we exit the main loop we will shut down */
   ecore_evas_shutdown();
}
</pre>
</div>
</p><p>
</p>

</td>
</tr>
</table>
</td>
</tr></table>
</div> <!-- Close the content div -->
<div id="bottom" style="width:100%; background-image:url('i/bottom.png'); background-repeat:no-repeat; background-position:'left bottom';"><img src=img/blank.gif width=120 height=120></div>

</body></html>

