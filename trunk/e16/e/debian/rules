#!/usr/bin/make  -f

# heavily modified debian/rules based on the
# sample debian/rules that uses debhelper. 

# original copyright info:
# GNU copyright 1997 by Joey Hess.

#sh = DH_COMPAT=2 DH_VERBOSE=1 /bin/ash -ex
#sh = DH_COMPAT=2 /bin/ash -e
sh = DH_COMPAT=2 /bin/sh -e 
SHELL := $(sh)

VPATH = debian
pwd := $(shell pwd)
export DH_OPTIONS=
e = enlightenment

build: 
	dh_testdir
	source debian/ehrc; eh_configure
	$(MAKE)
	touch debian/$@
clean:
	dh_testdir
	dh_testroot
	if [ -f Makefile ]; then $(MAKE) clean; fi
	dh_clean debian/build debian/install src/themes/Makefile.old econfig.h econfig.h.old
  
install: SHELL = DH_OPTIONS="-A" $(sh)
install: build
	dh_testdir
	dh_testroot
	dh_clean
	$(MAKE) install DESTDIR=$(pwd)/debian/${e}
	source debian/ehrc; eh_install
	touch debian/$@ 

binary-indep: SHELL = DH_OPTIONS="-i" $(sh)
binary-indep: build install
	dh_testversion 2
	dh_testdir
	dh_testroot
	dh_fixperms
	dh_installdeb
	dh_gencontrol
	dh_md5sums
	dh_builddeb

binary-arch: SHELL = DH_OPTIONS="-a" $(sh)
binary-arch: build install
	dh_testversion 2
	dh_testdir
	dh_testroot
	dh_installmenu
	dh_strip
	dh_fixperms
	dh_installdeb
	dh_shlibdeps
	dh_gencontrol
	dh_md5sums
	dh_builddeb

binary: binary-indep binary-arch
.PHONY: build clean binary-indep binary-arch binary install
